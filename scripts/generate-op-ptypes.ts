import * as fs from 'fs'
import { camelCase } from 'change-case'
import { buildOpModule, EnumDef, OpModule } from './build-op-module'
function* emitHeader() {
  yield `
  /* THIS FILE IS GENERATED BY ~/scripts/generate-op-ptypes.ts - DO NOT MODIFY DIRECTLY */
  import { IntrinsicEnumType } from './ptype-classes'


`
}

function* emitTypes(module: OpModule) {
  function* emitEnumPType(enumDef: EnumDef) {
    yield `export const ${camelCase(enumDef.tsName)}PType = new IntrinsicEnumType({
      name: '${enumDef.name}',
      module: '@algorandfoundation/algo-ts/op-types.d.ts',
      members: [`
    for (const member of enumDef.members) {
      yield `['${member.name}', '${member.value}'],`
    }
    yield `]});`
  }

  yield* emitHeader()
  for (const enumDef of module.enums) {
    yield* emitEnumPType(enumDef)
  }
  yield `\n`
}
const fullFilePathName = process.argv[2]

const opModule = buildOpModule()
fs.writeFileSync(fullFilePathName, Array.from(emitTypes(opModule)).join(''))
